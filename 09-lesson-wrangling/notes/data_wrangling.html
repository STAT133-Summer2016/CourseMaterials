<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew Do" />

<meta name="date" content="2016-06-23" />

<title>Data Wrangling</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Data Wrangling</h1>
<h4 class="author"><em>Andrew Do</em></h4>
<h4 class="date"><em>2016-06-23</em></h4>



<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>The literal meaning of <em>wrangling</em> is the herding or rounding up of animals for a specific purpose. As such, the inteded metaphor is that data wrangling is a process during which we transform a data set into a visualization-ready or analysis-ready form.</p>
</div>
<div id="example-data-set" class="section level2">
<h2>Example Data Set</h2>
<p>For the examples in these notes, we’ll draw on the data set <code>world.cities</code> from the <code>maps</code> package, which contains information on cities across the globe. The variables in this data set are <code>name</code>, <code>country</code>, <code>pop</code>, <code>lat</code>, <code>long</code>, and <code>capital</code>. <code>capital</code> takes on values from 0 to 3: 0 for noncapital, 1 for capital, 2 for China Municipalities, and 3 for China Provincial capitals. The first few rows of the data set are given below:</p>
<pre><code>## Source: local data frame [6 x 6]
## 
##                name   country   pop   lat  long capital
##               (chr)     (chr) (int) (dbl) (dbl)   (int)
## 1 Abasan al-Jadidah Palestine  5629 31.31 34.34       0
## 2 Abasan al-Kabirah Palestine 18999 31.32 34.35       0
## 3       Abdul Hakim  Pakistan 47788 30.55 72.11       0
## 4 Abdullah-as-Salam    Kuwait 21817 29.36 47.98       0
## 5              Abud Palestine  2456 32.03 35.07       0
## 6            Abwein Palestine  3434 32.03 35.20       0</code></pre>
</div>
<div id="data-wrangling-verbs" class="section level2">
<h2>Data Wrangling Verbs</h2>
<p>Data verbs transform your data table. Some modify variables, others create or delete existing ones. Below are the six data wrangling verbs we will deal with:</p>
<table style="width:112%;">
<colgroup>
<col width="16%"></col>
<col width="95%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Verb</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">filter</td>
<td align="left">keep rows matching criteria</td>
</tr>
<tr class="even">
<td align="left">select</td>
<td align="left">pick columns by name</td>
</tr>
<tr class="odd">
<td align="left">arrange</td>
<td align="left">reorder rows</td>
</tr>
<tr class="even">
<td align="left">summarise</td>
<td align="left">reduce a variable to a single value</td>
</tr>
<tr class="odd">
<td align="left">mutate</td>
<td align="left">create new variables/modify existing ones</td>
</tr>
<tr class="even">
<td align="left">group</td>
<td align="left">modifies the actions of mutate and summarise to groups in your data</td>
</tr>
</tbody>
</table>
<div id="filter" class="section level3">
<h3>filter</h3>
<p>To filter means to remove undesirable things. Therefore the purpose of <code>filter()</code> is to subset your data, keeping only cases that meet certain conditions. The first argument is the name of the data frame. The second and subsequent arguments are the expressions that filter the data frame. Those expressions should be logical statements of some sort.</p>
<div id="logical-statements" class="section level5">
<h5>Logical Statements</h5>
<p>Below is a table to refresh your memory of logical statements. In this table, <code>a</code> and <code>b</code> are numerical vectors. <code>p</code> and <code>q</code> are logical values (<code>TRUE</code> or <code>FALSE</code>).</p>
<table>
<thead>
<tr class="header">
<th align="left">Symbol</th>
<th align="left">Usage</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">==</td>
<td align="left">a == b</td>
<td align="left">Does a equal b?</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">a &lt;= b</td>
<td align="left">Is a less than or equal to b?</td>
</tr>
<tr class="odd">
<td align="left">&gt;=</td>
<td align="left">a &gt;= b</td>
<td align="left">Is a greater than or equal to b?</td>
</tr>
<tr class="even">
<td align="left">&lt;</td>
<td align="left">a &lt; b</td>
<td align="left">Is a less than b?</td>
</tr>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">a &gt; b</td>
<td align="left">Is a greater than b?</td>
</tr>
<tr class="even">
<td align="left">!</td>
<td align="left">!p</td>
<td align="left">Returns negation of p</td>
</tr>
<tr class="odd">
<td align="left">|</td>
<td align="left">p | q</td>
<td align="left">p OR q</td>
</tr>
<tr class="even">
<td align="left">&amp;</td>
<td align="left">p &amp; q</td>
<td align="left">p AND q</td>
</tr>
<tr class="odd">
<td align="left">xor</td>
<td align="left">xor(p, q)</td>
<td align="left">p XOR q (exclusive or)</td>
</tr>
<tr class="even">
<td align="left">%in%</td>
<td align="left">a %in% b</td>
<td align="left">Is a in b?</td>
</tr>
</tbody>
</table>
</div>
<div id="filtering-by-country" class="section level5">
<h5>Filtering by country</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">filter</span>(country ==<span class="st"> &quot;Palestine&quot;</span>)</code></pre></div>
<pre><code>## Source: local data frame [244 x 6]
## 
##                 name   country   pop   lat  long capital
##                (chr)     (chr) (int) (dbl) (dbl)   (int)
## 1  Abasan al-Jadidah Palestine  5629 31.31 34.34       0
## 2  Abasan al-Kabirah Palestine 18999 31.32 34.35       0
## 3               Abud Palestine  2456 32.03 35.07       0
## 4             Abwein Palestine  3434 32.03 35.20       0
## 5              Ajjah Palestine  5143 32.37 35.20       0
## 6             Anabta Palestine  7311 32.31 35.12       0
## 7              Anata Palestine  9149 31.81 35.28       0
## 8               Anin Palestine  3717 32.50 35.17       0
## 9              Anzah Palestine  2006 32.37 35.22       0
## 10      Aqbah Jabbar Palestine  6337 31.83 35.45       0
## ..               ...       ...   ...   ...   ...     ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">filter</span>(country %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Palestine&quot;</span>, <span class="st">&quot;Israel&quot;</span>))</code></pre></div>
<pre><code>## Source: local data frame [437 x 6]
## 
##                 name   country   pop   lat  long capital
##                (chr)     (chr) (int) (dbl) (dbl)   (int)
## 1  Abasan al-Jadidah Palestine  5629 31.31 34.34       0
## 2  Abasan al-Kabirah Palestine 18999 31.32 34.35       0
## 3               Abud Palestine  2456 32.03 35.07       0
## 4             Abwein Palestine  3434 32.03 35.20       0
## 5              Afula    Israel 39151 32.62 35.29       0
## 6              Ajjah Palestine  5143 32.37 35.20       0
## 7               Akko    Israel 45606 32.94 35.08       0
## 8             Anabta Palestine  7311 32.31 35.12       0
## 9              Anata Palestine  9149 31.81 35.28       0
## 10              Anin Palestine  3717 32.50 35.17       0
## ..               ...       ...   ...   ...   ...     ...</code></pre>
</div>
<div id="filtering-by-values" class="section level5">
<h5>Filtering by values</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">filter</span>(pop &lt;=<span class="st"> </span><span class="dv">6000</span>)</code></pre></div>
<pre><code>## Source: local data frame [14,731 x 6]
## 
##                 name   country   pop   lat  long capital
##                (chr)     (chr) (int) (dbl) (dbl)   (int)
## 1  Abasan al-Jadidah Palestine  5629 31.31 34.34       0
## 2               Abud Palestine  2456 32.03 35.07       0
## 3             Abwein Palestine  3434 32.03 35.20       0
## 4              Adale   Somalia  5492  2.75 46.30       0
## 5              Ajjah Palestine  5143 32.37 35.20       0
## 6               Alal    Jordan  4526 32.63 35.90       0
## 7              Alula   Somalia  5158 11.97 50.76       0
## 8               Anin Palestine  3717 32.50 35.17       0
## 9              Anzah Palestine  2006 32.37 35.22       0
## 10           Arranah Palestine  2144 32.50 35.32       0
## ..               ...       ...   ...   ...   ...     ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">filter</span>(pop &gt;=<span class="st"> </span><span class="dv">2000</span>, pop &lt;=<span class="st"> </span><span class="dv">6000</span>)</code></pre></div>
<pre><code>## Source: local data frame [7,344 x 6]
## 
##                 name   country   pop   lat  long capital
##                (chr)     (chr) (int) (dbl) (dbl)   (int)
## 1  Abasan al-Jadidah Palestine  5629 31.31 34.34       0
## 2               Abud Palestine  2456 32.03 35.07       0
## 3             Abwein Palestine  3434 32.03 35.20       0
## 4              Adale   Somalia  5492  2.75 46.30       0
## 5              Ajjah Palestine  5143 32.37 35.20       0
## 6               Alal    Jordan  4526 32.63 35.90       0
## 7              Alula   Somalia  5158 11.97 50.76       0
## 8               Anin Palestine  3717 32.50 35.17       0
## 9              Anzah Palestine  2006 32.37 35.22       0
## 10           Arranah Palestine  2144 32.50 35.32       0
## ..               ...       ...   ...   ...   ...     ...</code></pre>
</div>
</div>
<div id="select" class="section level3">
<h3>select</h3>
<p>To select means to pick out from. <code>select()</code> allows you to choose variables to keep from your data frame. Using a negative sign, it also allows you exclude variables, and naming arguments allows you to rename arguments.</p>
<div id="selecting-by-name" class="section level5">
<h5>Selecting by name</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">select</span>(name, country)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 2]
## 
##                 name      country
##                (chr)        (chr)
## 1  Abasan al-Jadidah    Palestine
## 2  Abasan al-Kabirah    Palestine
## 3        Abdul Hakim     Pakistan
## 4  Abdullah-as-Salam       Kuwait
## 5               Abud    Palestine
## 6             Abwein    Palestine
## 7            Adadlay      Somalia
## 8              Adale      Somalia
## 9               Afak         Iraq
## 10              Afif Saudi Arabia
## ..               ...          ...</code></pre>
</div>
<div id="excluding-by-name" class="section level5">
<h5>Excluding by name</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(-name, -country)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 4]
## 
##      pop   lat  long capital
##    (int) (dbl) (dbl)   (int)
## 1   5629 31.31 34.34       0
## 2  18999 31.32 34.35       0
## 3  47788 30.55 72.11       0
## 4  21817 29.36 47.98       0
## 5   2456 32.03 35.07       0
## 6   3434 32.03 35.20       0
## 7   9198  9.77 44.65       0
## 8   5492  2.75 46.30       0
## 9  22706 32.07 45.26       0
## 10 41731 23.92 42.93       0
## ..   ...   ...   ...     ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(-<span class="kw">c</span>(name, country))</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 4]
## 
##      pop   lat  long capital
##    (int) (dbl) (dbl)   (int)
## 1   5629 31.31 34.34       0
## 2  18999 31.32 34.35       0
## 3  47788 30.55 72.11       0
## 4  21817 29.36 47.98       0
## 5   2456 32.03 35.07       0
## 6   3434 32.03 35.20       0
## 7   9198  9.77 44.65       0
## 8   5492  2.75 46.30       0
## 9  22706 32.07 45.26       0
## 10 41731 23.92 42.93       0
## ..   ...   ...   ...     ...</code></pre>
</div>
<div id="renaming-while-selecting" class="section level5">
<h5>Renaming while selecting</h5>
<p>Note <code>select()</code> removes all the variables that weren’t explicitly selected. To keep all the other variables after selecting, use <code>rename()</code> instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">select</span>(<span class="dt">city_name =</span> name)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 1]
## 
##            city_name
##                (chr)
## 1  Abasan al-Jadidah
## 2  Abasan al-Kabirah
## 3        Abdul Hakim
## 4  Abdullah-as-Salam
## 5               Abud
## 6             Abwein
## 7            Adadlay
## 8              Adale
## 9               Afak
## 10              Afif
## ..               ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">city_name =</span> name)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##            city_name      country   pop   lat  long capital
##                (chr)        (chr) (int) (dbl) (dbl)   (int)
## 1  Abasan al-Jadidah    Palestine  5629 31.31 34.34       0
## 2  Abasan al-Kabirah    Palestine 18999 31.32 34.35       0
## 3        Abdul Hakim     Pakistan 47788 30.55 72.11       0
## 4  Abdullah-as-Salam       Kuwait 21817 29.36 47.98       0
## 5               Abud    Palestine  2456 32.03 35.07       0
## 6             Abwein    Palestine  3434 32.03 35.20       0
## 7            Adadlay      Somalia  9198  9.77 44.65       0
## 8              Adale      Somalia  5492  2.75 46.30       0
## 9               Afak         Iraq 22706 32.07 45.26       0
## 10              Afif Saudi Arabia 41731 23.92 42.93       0
## ..               ...          ...   ...   ...   ...     ...</code></pre>
</div>
</div>
<div id="arrange" class="section level3">
<h3>arrange</h3>
<p>To arrange means to put in a neat, attractive order. <code>arrange()</code> does exactly that. By default, numerical values are arranged from least to greatest; character values are arranged in alphabetical order; and factors, if they have a natural ordering, are arranged in their specified order.</p>
<div id="ordering-multiple-variables" class="section level5">
<h5>Ordering multiple variables</h5>
<p>The ordering of the arguments of <code>arrange()</code> matters. Compare the results below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(country, name)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##           name     country   pop   lat  long capital
##          (chr)       (chr) (int) (dbl) (dbl)   (int)
## 1         Acin Afghanistan 15423 34.12 70.70       0
## 2     Ali Hayl Afghanistan 12834 33.94 69.70       0
## 3  Anar Darreh Afghanistan 10228 32.75 61.65       0
## 4      Andarab Afghanistan 27441 35.62 69.21       0
## 5      Andhvoy Afghanistan 29905 36.93 65.10       0
## 6        Aqcah Afghanistan 52339 36.93 66.16       0
## 7     Asadabad Afghanistan 51970 34.87 71.15       0
## 8        Asmar Afghanistan 16158 35.03 71.37       0
## 9        Awbeh Afghanistan  7673 34.39 63.14       0
## 10       Aybak Afghanistan 51068 36.26 68.04       0
## ..         ...         ...   ...   ...   ...     ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(name, country)</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##                    name     country    pop   lat  long capital
##                   (chr)       (chr)  (int) (dbl) (dbl)   (int)
## 1                     A      Norway   1163 63.97 10.21       0
## 2              A Coruna       Spain 243088 43.33 -8.42       0
## 3        A dos Cunhados    Portugal   6508 39.15 -9.29       0
## 4             A Estrada       Spain  21997 42.70 -8.50       0
## 5             A Laracha       Spain  10856 43.25 -8.59       0
## 6  A Pobra do Caraminal       Spain   9955 42.61 -8.94       0
## 7           A Ver-o-Mar    Portugal  10971 41.40 -8.76       0
## 8           Aa en Hunze Netherlands  25005 53.05  6.70       0
## 9              Aabenraa     Denmark  16409 55.05  9.42       0
## 10              Aabybro     Denmark   4922 57.15  9.75       0
## ..                  ...         ...    ...   ...   ...     ...</code></pre>
</div>
<div id="arrange-in-descending-order" class="section level5">
<h5>Arrange in descending order</h5>
<p>To arrange in descending order (or reverse alphabetical order), use the <code>desc()</code> helper function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(name))</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##          name     country    pop   lat  long capital
##         (chr)       (chr)  (int) (dbl) (dbl)   (int)
## 1      Zywiec      Poland  31905 49.87 19.18       0
## 2   Zytkavicy     Belarus  13500 52.22 27.86       0
## 3  Zyryanovsk  Kazakhstan  44744 49.75 84.26       0
## 4    Zyrardow      Poland  41022 52.06 20.45       0
## 5   Zymohirya     Ukraine  10776 48.59 38.93       0
## 6  Zymna Voda     Ukraine   9515 49.81 23.88       0
## 7        Zygi      Cyprus    531 34.73 33.34       0
## 8     Zychlin      Poland   8726 52.25 19.62       0
## 9      Zwolle Netherlands 112730 52.52  6.09       0
## 10    Zwingen Switzerland   2189 47.43  7.52       0
## ..        ...         ...    ...   ...   ...     ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(pop))</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##            name     country      pop    lat   long capital
##           (chr)       (chr)    (int)  (dbl)  (dbl)   (int)
## 1      Shanghai       China 15017783  31.23 121.47       2
## 2        Bombay       India 12883645  18.96  72.82       0
## 3       Karachi    Pakistan 11969284  24.86  67.01       0
## 4  Buenos Aires   Argentina 11595183 -34.61 -58.37       1
## 5         Delhi       India 11215130  28.67  77.21       0
## 6        Manila Philippines 10546511  14.62 120.97       1
## 7        Moscow      Russia 10472629  55.75  37.62       1
## 8          Soul Korea South 10409345  37.56 126.99       1
## 9     Sao Paulo      Brazil 10059502 -23.53 -46.63       0
## 10     Istanbul      Turkey 10034830  41.10  29.00       0
## ..          ...         ...      ...    ...    ...     ...</code></pre>
</div>
</div>
<div id="summarise" class="section level3">
<h3>summarise</h3>
<p>To summarize means to make a brief statement about the mains points of something. <code>summarise</code> makes a statement about variables by boiling them down to one value through <strong>reduction functions</strong>. Reduction functions summarize or reduce a variable to a single number or character string. Below is a table of common reduction functions. They are commonly used with <code>summarise()</code> but can be used with <code>mutate()</code> as well.</p>
<table style="width:101%;">
<colgroup>
<col width="22%"></col>
<col width="79%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>mean()</code></td>
<td align="left">finds the arithmetic average</td>
</tr>
<tr class="even">
<td align="left"><code>sum()</code></td>
<td align="left">adds up all the values</td>
</tr>
<tr class="odd">
<td align="left"><code>n()</code></td>
<td align="left">counts the number of cases</td>
</tr>
<tr class="even">
<td align="left"><code>min()</code></td>
<td align="left">finds the smallest value</td>
</tr>
<tr class="odd">
<td align="left"><code>max()</code></td>
<td align="left">finds the largest value</td>
</tr>
<tr class="even">
<td align="left"><code>median()</code></td>
<td align="left">finds the 50th percentile</td>
</tr>
<tr class="odd">
<td align="left"><code>quantile()</code></td>
<td align="left">finds the nth percentile</td>
</tr>
<tr class="even">
<td align="left"><code>sd</code></td>
<td align="left">finds the sample standard deviation</td>
</tr>
<tr class="odd">
<td align="left"><code>var</code></td>
<td align="left">finds the sample variance</td>
</tr>
<tr class="even">
<td align="left"><code>n_distinct</code></td>
<td align="left">counts the number of unique values</td>
</tr>
</tbody>
</table>
<div id="basic-usage-of-summarise" class="section level5">
<h5>Basic usage of summarise</h5>
<p>Calling summarise will almost always make your data frame smaller as you are reducing the information carried in variables down to a single value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">med_pop =</span> <span class="kw">median</span>(pop))</code></pre></div>
<pre><code>## Source: local data frame [1 x 1]
## 
##   med_pop
##     (int)
## 1   12668</code></pre>
</div>
</div>
<div id="mutate" class="section level3">
<h3>mutate</h3>
<p>To mutate means to change in form. <code>mutate()</code> changes a variable or adds new ones based on existing variables through <strong>transformation functions</strong>. Transformation functions take one or more variables as input and returns a new variable. Unlike reduction functions, which <em>reduce</em> the data to a single number, transformation functions <em>transform</em> the data from one form to another, producing a number for each case. Often, transformation functions come in the form mathematical operations, but also include operations such as logical comparisons and string manipulations. Transformation functions typically only work with <code>mutate()</code>. Examples include:</p>
<ul>
<li><code>weight / height</code></li>
<li><code>log(population)</code></li>
<li><code>round(age)</code></li>
<li><code>str_replace(name, &quot;,&quot;, &quot; &quot;)</code></li>
<li><code>score &gt; 90</code></li>
</ul>
<div id="changing-existing-variables" class="section level5">
<h5>Changing existing variables</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">str_to_upper</span>(name))</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##                 name      country   pop   lat  long capital
##                (chr)        (chr) (int) (dbl) (dbl)   (int)
## 1  ABASAN AL-JADIDAH    Palestine  5629 31.31 34.34       0
## 2  ABASAN AL-KABIRAH    Palestine 18999 31.32 34.35       0
## 3        ABDUL HAKIM     Pakistan 47788 30.55 72.11       0
## 4  ABDULLAH-AS-SALAM       Kuwait 21817 29.36 47.98       0
## 5               ABUD    Palestine  2456 32.03 35.07       0
## 6             ABWEIN    Palestine  3434 32.03 35.20       0
## 7            ADADLAY      Somalia  9198  9.77 44.65       0
## 8              ADALE      Somalia  5492  2.75 46.30       0
## 9               AFAK         Iraq 22706 32.07 45.26       0
## 10              AFIF Saudi Arabia 41731 23.92 42.93       0
## ..               ...          ...   ...   ...   ...     ...</code></pre>
</div>
<div id="adding-new-variables" class="section level5">
<h5>Adding new variables</h5>
<p>Note that you can immediately use your new variable in the same <code>mutate()</code> call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">doublepop =</span> <span class="dv">2</span>*pop,
         <span class="dt">quadpop =</span> <span class="dv">2</span>*doublepop) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-<span class="kw">c</span>(lat, long))</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 6]
## 
##                 name      country   pop capital doublepop quadpop
##                (chr)        (chr) (int)   (int)     (dbl)   (dbl)
## 1  Abasan al-Jadidah    Palestine  5629       0     11258   22516
## 2  Abasan al-Kabirah    Palestine 18999       0     37998   75996
## 3        Abdul Hakim     Pakistan 47788       0     95576  191152
## 4  Abdullah-as-Salam       Kuwait 21817       0     43634   87268
## 5               Abud    Palestine  2456       0      4912    9824
## 6             Abwein    Palestine  3434       0      6868   13736
## 7            Adadlay      Somalia  9198       0     18396   36792
## 8              Adale      Somalia  5492       0     10984   21968
## 9               Afak         Iraq 22706       0     45412   90824
## 10              Afif Saudi Arabia 41731       0     83462  166924
## ..               ...          ...   ...     ...       ...     ...</code></pre>
</div>
</div>
<div id="group_by" class="section level3">
<h3>group_by</h3>
<p>Central to the usage of <code>summarise()</code> and <code>mutate()</code> is the idea of grouping, which subsets your data set based off some variable and restricts <code>summarise()</code> and <code>mutate()</code> to working only within those subgroups. <code>group_by()</code>, on the surface, doesn’t actually change your data frame. It does some set-up magic in the background so that other verbs like <code>summarise</code> and <code>mutate()</code> will act on a group-by-group basis. In other words, <code>group_by</code> won’t do anything unless it’s followed by another verb. <code>ungroup()</code> removes the grouping.</p>
<div id="basic-group_by-usage" class="section level5">
<h5>Basic group_by usage</h5>
<p>Compare how <code>summarise()</code> and <code>mutate()</code> differ when given the same functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">num_cities =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## Source: local data frame [239 x 2]
## 
##                country num_cities
##                  (chr)      (int)
## 1          Afghanistan        117
## 2              Albania         67
## 3              Algeria        316
## 4       American Samoa         35
## 5              Andorra          7
## 6               Angola         37
## 7             Anguilla          8
## 8  Antigua and Barbuda         13
## 9            Argentina         82
## 10             Armenia        402
## ..                 ...        ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_cities =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## Source: local data frame [43,645 x 7]
## Groups: country [239]
## 
##                 name      country   pop   lat  long capital num_cities
##                (chr)        (chr) (int) (dbl) (dbl)   (int)      (int)
## 1  Abasan al-Jadidah    Palestine  5629 31.31 34.34       0        244
## 2  Abasan al-Kabirah    Palestine 18999 31.32 34.35       0        244
## 3        Abdul Hakim     Pakistan 47788 30.55 72.11       0        418
## 4  Abdullah-as-Salam       Kuwait 21817 29.36 47.98       0         70
## 5               Abud    Palestine  2456 32.03 35.07       0        244
## 6             Abwein    Palestine  3434 32.03 35.20       0        244
## 7            Adadlay      Somalia  9198  9.77 44.65       0         63
## 8              Adale      Somalia  5492  2.75 46.30       0         63
## 9               Afak         Iraq 22706 32.07 45.26       0         80
## 10              Afif Saudi Arabia 41731 23.92 42.93       0        186
## ..               ...          ...   ...   ...   ...     ...        ...</code></pre>
</div>
<div id="multiple-groupings" class="section level5">
<h5>Multiple groupings</h5>
<p>When more than one variable is used, the data set is subsetted into groups based off unique combinations of the subsetting variables. Groupings can also be made on-the-fly using existing variables. In the example below, we split the globe into four quadrants using lat and long and group cities using those quadrants.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(lat &gt;<span class="st"> </span><span class="dv">0</span>, long &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_pop =</span> <span class="kw">mean</span>(pop)) %&gt;%
<span class="st">  </span>ungroup</code></pre></div>
<pre><code>## Source: local data frame [4 x 3]
## 
##   lat &gt; 0 long &gt; 0  avg_pop
##     (lgl)    (lgl)    (dbl)
## 1   FALSE    FALSE 82984.21
## 2   FALSE     TRUE 69586.28
## 3    TRUE    FALSE 45645.26
## 4    TRUE     TRUE 58838.04</code></pre>
</div>
</div>
<div id="chaining-multiple-verbs" class="section level3">
<h3>Chaining Multiple Verbs</h3>
<p>These data verbs are at their most powerful when you chain them together, piping the output of one verb into the action of another, forming a data pipeline. It may seem daunting at first to come up with your own data pipeline, but with practice comes intuition on good ways to break large problems into smaller tasks.</p>
<p>There are three steps to successful wrangling:</p>
<ul>
<li>Plan your wrangling in plain language</li>
<li>Formalize your plan in the language of wrangling verbs</li>
<li>Write your code according to your plan</li>
</ul>
<div id="worked-out-multi-step-wrangling" class="section level5">
<h5>Worked out multi-step wrangling</h5>
<p>Compare the average population of capitals in the northern hemisphere with that of capitals in the southern part of the world.</p>
<p>First, we plan out in words what we have to do:</p>
<ol style="list-style-type: decimal">
<li>Only look at capital cities</li>
<li>Distinguish between nothern and southern hemisphere using lat</li>
<li>Group the cities using the north/south designation</li>
<li>Find the average population in those subgroups</li>
<li>Order the data by average population</li>
</ol>
<p>Then we translate those ideas into data verbs</p>
<ol style="list-style-type: decimal">
<li><code>filter()</code> out cities that do not have a <code>capital</code> value of <code>1</code></li>
<li><code>mutate()</code> <code>latitude</code>, creating a new logical variable <code>north</code> based off whether or not a city is above the 0th <code>latitude</code> line</li>
<li><code>group_by()</code> <code>north</code></li>
<li><code>summarise()</code> the <code>population</code> variable within the groups using <code>mean</code></li>
<li><code>arrange</code> the average from least to greatest</li>
</ol>
<p>Now we write the code. Luckily our wrangling verbs are easily translated into code via <code>dplyr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcities %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(capital !=<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">north =</span> lat &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(north) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_pop =</span> <span class="kw">mean</span>(pop)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(avg_pop)</code></pre></div>
<pre><code>## Source: local data frame [2 x 2]
## 
##   north  avg_pop
##   (lgl)    (dbl)
## 1  TRUE 49380.53
## 2 FALSE 63887.92</code></pre>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
